# **BT4103 Capstone Project: Using Machine Learning to Explore Decarbonization Strategies**

---
This project aims to develop an end-to-end data driven solution to provide insights into decarbonization efforts of companies from publicly available unstructured and structured data through:
- Utilizing Natural Language Processing and Machine Learning to analyze textual data
- Utilizing Computer Vision techniques to extract tabular data
- Building a web application dasbhoard to present analysis results


## Overview
Our dataset consists of 2021 sustainability reports belonging to companies from the Energy sector. 
Based on a list of decarbonization questions provided by our project sponsor NatWest, our final objective is to find the answers to these questions from the reports
and present them in an interactive and comprehensive manner via a web application dashboard. The list of questions can be found at the end of the page.
![alt text](https://github.com/mltnsia/capstone/blob/322977965947025b4882914bf507ad5eb0c8ef7a/pipeline_overview.png)

## User Guide
Python version: 3.9.7

To install all packages used: 
`pip install -r requirements.txt`

To run the full pipeline:
1) Replace [New_URLs.csv](https://github.com/mltnsia/capstone/blob/322977965947025b4882914bf507ad5eb0c8ef7a/Data_Pipeline/New_URLs.csv) with the details of the reports to be processed
2) Run [Final_Pipeline.ipynb](https://github.com/mltnsia/capstone/blob/322977965947025b4882914bf507ad5eb0c8ef7a/Data_Pipeline/Final_Pipeline.ipynb)
3) Retrieve answers from the newly generated [consolidated_output.csv](https://github.com/mltnsia/capstone/blob/322977965947025b4882914bf507ad5eb0c8ef7a/Data_Pipeline/consolidated_output.csv)

## CSV Files
| File | Content |
|------|---------|
| Processed_Corp_List.csv | Train set companies and reports URLs |
| Labelled_Answers.csv | Train set labels (y_train) |
| New_URLs.csv | Test set companies and reports URLs |
| New_Corp_List.csv | Intermediate file generated by Final_Pipeline.ipynb |
| consolidated_output.csv | Output of the full pipeline |


## Python Files
The following table explains the python files used in Final_Pipeline.ipynb:
| File | Process | Explanation |
|-----|------|---------|
| preprocessing_helper.py | Text Preprocessing | Preprocesses textual data for supervised and unsupervised ML |
| machine_learning_helper.py | Machine Learning | Conducts feature engineering and ML model training/ prediction |
| backtesting.py | Machine Learning | Evaluates ML models using Stratified KFold |
| cosine_similarity.py | Relevant Sentences Extraction | Extracts top 3 most relevant sentences using cosine similarity |
| table_extraction.py | Table Extraction | Converts PDF reports into textual format and conducts filtering based on heuristics to detect target tables |
| pdf_to_jpg.py | Table Extraction | Retrieves target pages and converts them to image files |
| crop_jpg.py | Table Extraction | Locates coordinates of the corners of the table for cropping |


## Dashboard Files
Note: The dashboard was created on NatWest's analytics software Dataiku.
| File | Content |
|------|---------|
| app.py | Application's root file |
| index.html | Application's HTML file |
| styles.css | Application's CSS file |

## List of Decarbonization Questions and Answer Types
| Question            | Answer Type     |
|-------------------- |-----------------|
| What are your absolute Scope 1 and 2 emissions? | Tabular (JPEG) |
| What are your absolute Scope 3 emissions? | Tabular (JPEG) |
| Have your Scope 1, 2 and Scope 3 emissions been verified by a third party? | Binary |
| What does your medium term (5 10 years) Scope 1 - 2 target equate to in % reduction? | Open-ended |
| What is your medium term (5 10 years) target for reduction in Scope 3 Downstream emissions? | Open-ended |
| Do you have a long term net zero target/commitment? | Binary |
| DDo you have a low carbon transition plan? | Scale |
| Do you provide incentives to your senior leadership team for the management of climate related issues? | Binary |
| Do you engage in activities that influence public policy on climate related issues to support a net zero aligned transition through any of the following? Direct engagement with (1) policy makers; (2) funding research organizations; (3) trade associations | Binary |
| Do you set targets for the production or consumption of renewable energy? | Binary |
| Does your transition plan include direct engagement with suppliers to drive them to reduce their emissions, or even switching to suppliers producing low carbon materials? | Binary |
| Does you set targets for production of more energy efficient or environmentally friendly products (e.g. Carbon Capture, Hydrogen generation, battery storage)? | Binary |
| Do you engage with your value chain on climate related issues? | Binary |


